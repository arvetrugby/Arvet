<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equipo - ARVET</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <a href="index.html" class="logo">ARVET</a>
            <div class="nav-links">
                <a href="#portada">Inicio</a>
                <a href="#quienes-somos">Nosotros</a>
                <a href="#plantel">Plantel</a>
                <a href="#partidos">Partidos</a>
                <a href="login.html" class="btn-login">Login</a>
            </div>
        </div>
    </nav>

    <!-- Portada -->
    <section id="portada" class="hero" style="margin-top: 70px;">
        <div class="container">
            <div id="equipoHeader">
                <div class="loading">Cargando equipo...</div>
            </div>
        </div>
    </section>

    <!-- Qui√©nes Somos -->
    <section id="quienes-somos" class="section">
        <div class="container">
            <h2>üìã Qui√©nes Somos</h2>
            <div id="quienesSomosContent" class="card">
                <div class="loading">Cargando informaci√≥n...</div>
            </div>
        </div>
    </section>

    <!-- Comisi√≥n -->
    <section id="comision" class="section" style="background: #f1f5f9;">
        <div class="container">
            <h2>üë• Comisi√≥n Directiva</h2>
            <div id="comisionGrid" class="results-grid">
                <div class="loading">Cargando comisi√≥n...</div>
            </div>
        </div>
    </section>

    <!-- Plantel -->
    <section id="plantel" class="section">
        <div class="container">
            <h2>‚öΩ Plantel</h2>
            <div id="plantelGrid" class="results-grid">
                <div class="loading">Cargando plantel...</div>
            </div>
        </div>
    </section>

    <!-- Partidos -->
    <section id="partidos" class="section" style="background: #f1f5f9;">
        <div class="container">
            <h2>‚öîÔ∏è Pr√≥ximos Partidos</h2>
            <div id="partidosEquipoList" class="partidos-list">
                <div class="loading">Cargando partidos...</div>
            </div>
        </div>
    </section>

    <!-- Galer√≠a -->
    <section id="galeria" class="section">
        <div class="container">
            <h2>üì∏ Galer√≠a</h2>
            <div id="galeriaGrid" class="paises-grid">
                <p>Galer√≠a de fotos del equipo</p>
            </div>
        </div>
        
    </section>
<!-- Mapa -->
<section id="ubicacion" class="section" style="background: #f1f5f9;">
    <div class="container">
        <h2>üìç Ubicaci√≥n</h2>
        <div id="map" style="height: 400px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"></div>
    </div>
</section>
    <script src="js/app.js"></script>
    <script>
        
        // Cargar datos del equipo
        let slug = new URLSearchParams(window.location.search).get('slug');

if (!slug) {
    slug = window.location.pathname.replace("/", "");
}

if (slug) {
    cargarEquipo(slug);
}

        async function cargarEquipo(slug) {
    try {
        const response = await fetchAPI('getEquipoBySlug', { slug });

        if (response.success) {
            const equipo = response.data;

            window.equipoData = equipo;

            document.getElementById('equipoHeader').innerHTML = `
                <h1>${equipo.nombre}</h1>
                <p>${equipo.ciudad}, ${equipo.pais}</p>
                <p>${equipo.descripcion || ''}</p>
            `;

            document.getElementById('quienesSomosContent').innerHTML = `
                <p>${equipo.historia || 'Sin informaci√≥n disponible'}</p>
                <p><strong>Fundaci√≥n:</strong> ${equipo.fechaFundacion || 'N/A'}</p>
                <p><strong>Colores:</strong> ${equipo.colores || 'N/A'}</p>
            `;

            cargarJugadores(equipo.id);
            cargarPartidosEquipo(equipo.id);

            // Mostrar mapa si hay coordenadas
            if (equipo.lat && equipo.lng) {
    window.equipoCoords = {
        lat: equipo.lat,
        lng: equipo.lng
    };
}
        }

    } catch (error) {
        console.error(error);
    }
}
        async function cargarJugadores(equipoId) {
            try {
                const response = await fetchAPI('getJugadores', { equipoId });
                if (response.success) {
                    const jugadores = response.data;
                    
                    // Separar comisi√≥n
                    const comision = jugadores.filter(j => j.rol && j.rol !== 'Jugador');
                    const plantel = jugadores.filter(j => !j.rol || j.rol === 'Jugador');
                    
                    document.getElementById('comisionGrid').innerHTML = comision.map(j => `
                        <div class="card">
                            <h3>${j.nombre} ${j.apellido}</h3>
                            <p class="badge badge-success">${j.rol}</p>
                        </div>
                    `).join('') || '<p>Sin comisi√≥n registrada</p>';
                    
                    document.getElementById('plantelGrid').innerHTML = plantel.map(j => `
                        <div class="card">
                            <h3>#${j.numeroCamiseta || '-'} ${j.nombre} ${j.apellido}</h3>
                            <p>${j.posicion || 'Jugador'}</p>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error(error);
            }
        }

        async function cargarPartidosEquipo(equipoId) {
            try {
                const response = await fetchAPI('getPartidos', { equipoId });
                if (response.success) {
                    document.getElementById('partidosEquipoList').innerHTML = response.data.map(partido => {
                        const fecha = formatDate(partido.fecha);
                        return `
                            <div class="partido-card">
                                <div class="partido-info">
                                    <h3>vs ${partido.rival}</h3>
                                    <div class="partido-meta">
                                        <span>üìç ${partido.lugar}</span>
                                        <span>üïê ${partido.hora}</span>
                                    </div>
                                </div>
                                <div class="partido-fecha">
                                    <div class="dia">${fecha.dia}</div>
                                    <div class="mes">${fecha.mes}</div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            } catch (error) {
                console.error(error);
            }
        }
    </script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<script>
document.addEventListener("DOMContentLoaded", function () {
    // Esperar a que carguen los datos del equipo
    setTimeout(() => {
        inicializarMapa();
    }, 1000);
});

function inicializarMapa() {
    let lat, lng, zoom;
    
    // Si hay coordenadas del equipo, usarlas
    if (window.equipoCoords && window.equipoCoords.lat && window.equipoCoords.lng) {
        lat = parseFloat(window.equipoCoords.lat);
        lng = parseFloat(window.equipoCoords.lng);
        zoom = 15;
    } else {
        // Coordenadas por defecto (Argentina centro)
        lat = -34.6037;
        lng = -58.3816;
        zoom = 13;
    }
    
    const map = L.map('map').setView([lat, lng], zoom);
    
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
    
    L.marker([lat, lng])
        .addTo(map)
        .bindPopup("üìç Ubicaci√≥n del equipo")
        .openPopup();
}
</script>

</body>
</html>
